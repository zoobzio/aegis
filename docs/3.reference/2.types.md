---
title: Types Reference
description: Type definitions and field descriptions
author: zoobzio
published: 2025-02-18
updated: 2025-02-18
tags:
  - aegis
  - reference
  - types
---

# Types Reference

This document describes the core types in aegis.

## Node

```go
type Node struct {
    ID          string
    Name        string
    Type        NodeType
    Address     string
    Services    []ServiceInfo
    Health      *HealthInfo
    PeerManager *PeerManager
    MeshServer  *MeshServer
    Topology    *Topology
    TLSConfig   *TLSConfig
}
```

| Field | Type | Description |
|-------|------|-------------|
| ID | `string` | Unique identifier, used in certificates |
| Name | `string` | Human-readable label |
| Type | `NodeType` | Classification (e.g., gateway, worker) |
| Address | `string` | Host:port for connections |
| Services | `[]ServiceInfo` | Services this node provides |
| Health | `*HealthInfo` | Current health status |
| PeerManager | `*PeerManager` | Manages outgoing connections |
| MeshServer | `*MeshServer` | gRPC server for incoming connections |
| Topology | `*Topology` | View of mesh membership |
| TLSConfig | `*TLSConfig` | Certificates and TLS settings |

---

## NodeType

```go
type NodeType string

const (
    NodeTypeGeneric NodeType = "generic"
)
```

Node classification. Applications can define custom types.

---

## NodeInfo

```go
type NodeInfo struct {
    ID        string
    Name      string
    Type      NodeType
    Address   string
    Services  []ServiceInfo
    JoinedAt  time.Time
    UpdatedAt time.Time
}
```

| Field | Type | Description |
|-------|------|-------------|
| ID | `string` | Node identifier |
| Name | `string` | Node name |
| Type | `NodeType` | Node type |
| Address | `string` | Node address |
| Services | `[]ServiceInfo` | Services the node provides |
| JoinedAt | `time.Time` | When node joined topology |
| UpdatedAt | `time.Time` | Last update timestamp |

---

## ServiceInfo

```go
type ServiceInfo struct {
    Name    string
    Version string
}
```

| Field | Type | Description |
|-------|------|-------------|
| Name | `string` | Service name (e.g., "identity") |
| Version | `string` | Service version (e.g., "v1") |

---

## PeerInfo

```go
type PeerInfo struct {
    ID      string
    Type    NodeType
    Address string
}
```

| Field | Type | Description |
|-------|------|-------------|
| ID | `string` | Peer node ID |
| Type | `NodeType` | Peer node type |
| Address | `string` | Peer address for connection |

---

## Peer

```go
type Peer struct {
    Info   PeerInfo
    Client MeshServiceClient
    Conn   *grpc.ClientConn
}
```

| Field | Type | Description |
|-------|------|-------------|
| Info | `PeerInfo` | Peer metadata |
| Client | `MeshServiceClient` | gRPC client for mesh operations |
| Conn | `*grpc.ClientConn` | Underlying connection |

---

## Topology

```go
type Topology struct {
    Nodes     map[string]NodeInfo
    Version   int64
    UpdatedAt time.Time
}
```

| Field | Type | Description |
|-------|------|-------------|
| Nodes | `map[string]NodeInfo` | Node ID to info mapping |
| Version | `int64` | Monotonically increasing version |
| UpdatedAt | `time.Time` | Last modification time |

---

## Caller

```go
type Caller struct {
    NodeID      string
    Certificate *x509.Certificate
}
```

| Field | Type | Description |
|-------|------|-------------|
| NodeID | `string` | Calling node's ID (from certificate CN) |
| Certificate | `*x509.Certificate` | Full client certificate |

---

## HealthInfo

```go
type HealthInfo struct {
    Status      HealthStatus
    LastChecked time.Time
    Message     string
    Error       string
}
```

| Field | Type | Description |
|-------|------|-------------|
| Status | `HealthStatus` | Current status |
| LastChecked | `time.Time` | When last checked |
| Message | `string` | Human-readable message |
| Error | `string` | Error message if unhealthy |

---

## HealthStatus

```go
type HealthStatus string

const (
    HealthStatusHealthy   HealthStatus = "healthy"
    HealthStatusUnhealthy HealthStatus = "unhealthy"
    HealthStatusUnknown   HealthStatus = "unknown"
)
```

---

## HealthChecker

```go
type HealthChecker interface {
    Check(ctx context.Context) error
    Name() string
}
```

Interface for health check implementations.

---

## TLSOptions

```go
type TLSOptions struct {
    Source       CertificateSource
    CertFile     string
    KeyFile      string
    CAFile       string
    CertEnvVar   string
    KeyEnvVar    string
    CAEnvVar     string
    VaultPath    string
    VaultRole    string
    VerifyChain  bool
    AllowExpired bool
    RequiredSANs []string
}
```

| Field | Type | Description |
|-------|------|-------------|
| Source | `CertificateSource` | Where to load certificates from |
| CertFile | `string` | Path to certificate (file source) |
| KeyFile | `string` | Path to private key (file source) |
| CAFile | `string` | Path to CA certificate (file source) |
| CertEnvVar | `string` | Env var for certificate (env source) |
| KeyEnvVar | `string` | Env var for private key (env source) |
| CAEnvVar | `string` | Env var for CA certificate (env source) |
| VaultPath | `string` | Vault path (vault source, future) |
| VaultRole | `string` | Vault role (vault source, future) |
| VerifyChain | `bool` | Verify full certificate chain |
| AllowExpired | `bool` | Accept expired certificates |
| RequiredSANs | `[]string` | Required Subject Alternative Names |

---

## CertificateSource

```go
type CertificateSource string

const (
    CertSourceFile  CertificateSource = "file"
    CertSourceEnv   CertificateSource = "env"
    CertSourceVault CertificateSource = "vault"
)
```

---

## TLSConfig

```go
type TLSConfig struct {
    Certificate tls.Certificate
    CertPool    *x509.CertPool
    // internal fields
}
```

| Field | Type | Description |
|-------|------|-------------|
| Certificate | `tls.Certificate` | Node's certificate and key |
| CertPool | `*x509.CertPool` | Trusted CA certificates |

**Methods:**
- `GetServerTLSConfig() *tls.Config` — Returns server TLS config
- `GetClientTLSConfig(serverName string) *tls.Config` — Returns client TLS config

---

## ServiceRegistrar

```go
type ServiceRegistrar func(*grpc.Server)
```

Callback to register gRPC services on the server.

---

## Error Sentinels

```go
var (
    ErrNoProviders   = errors.New("no providers available for service")
    ErrNoTLSConfig   = errors.New("node has no TLS configuration")
    ErrNoPeerInfo    = errors.New("no peer info in context")
    ErrNoTLSInfo     = errors.New("no TLS info in peer")
    ErrNoCertificate = errors.New("no client certificate")
)
```

---

## Next Steps

- [API Reference](1.api.md) — Function signatures
- [Concepts](../1.learn/3.concepts.md) — Mental models
