---
title: Quickstart
description: Build a provider and consumer in five minutes
author: zoobzio
published: 2025-02-18
updated: 2025-02-18
tags:
  - aegis
  - quickstart
  - tutorial
---

# Quickstart

This guide walks through creating two nodes: a provider that exposes a service, and a consumer that calls it.

## Installation

```bash
go get github.com/zoobzio/aegis
```

Requires Go 1.24+.

## Basic Usage

A minimal node with automatic certificate generation:

```go
package main

import "github.com/zoobzio/aegis"

func main() {
    node, err := aegis.NewNodeBuilder().
        WithID("my-node").
        WithName("My Node").
        WithAddress("localhost:8443").
        WithCertDir("./certs").
        Build()
    if err != nil {
        panic(err)
    }

    node.StartServer()
    defer node.Shutdown()

    // Node is now accepting mTLS connections
    select {}
}
```

On first run, aegis generates a CA and node certificate in `./certs`. Subsequent runs load existing certificates.

## Declaring Services

Nodes can declare which services they provide:

```go
node, _ := aegis.NewNodeBuilder().
    WithID("identity-1").
    WithName("Identity Server").
    WithAddress("localhost:8443").
    WithServices(aegis.ServiceInfo{Name: "identity", Version: "v1"}).
    WithCertDir("./certs").
    Build()
```

Other nodes can then query for providers:

```go
providers := node.Topology.GetServiceProviders("identity", "v1")
// Returns []NodeInfo with addresses of nodes providing identity.v1
```

See the [Services Guide](../2.guides/3.services.md) for registering gRPC service implementations.

## Connecting to Peers

Add peers to enable topology synchronization:

```go
err := node.AddPeer(aegis.PeerInfo{
    ID:      "other-node",
    Type:    aegis.NodeTypeGeneric,
    Address: "other-host:8443",
})
```

Peers connect using mTLS. Once connected, topology syncs automatically.

## Calling Services

Use `ServiceClientPool` to call services across the mesh:

```go
pool := aegis.NewServiceClientPool(node)
defer pool.Close()

// Create typed client for a specific service
client := aegis.NewServiceClient(pool, "identity", "v1", identity.NewIdentityServiceClient)

// Get connection (round-robin across providers)
identityClient, err := client.Get(ctx)
if err != nil {
    return err
}

resp, err := identityClient.ValidateSession(ctx, &identity.ValidateSessionRequest{
    Token: token,
})
```

See [Service Client](../3.reference/1.api.md#serviceclientpool) for connection pooling details.

## Health Checks

Nodes track their health status:

```go
// Set health directly
node.SetHealth(aegis.HealthStatusHealthy, "All systems operational", nil)

// Or use a health checker
checker := aegis.NewFunctionHealthChecker("database", func(ctx context.Context) error {
    return db.Ping(ctx)
})
node.CheckHealth(ctx, checker)
```

## Next Steps

- [Concepts](3.concepts.md) — Mental models for nodes, peers, and topology
- [Architecture](4.architecture.md) — How mTLS and topology sync work internally
- [Services Guide](../2.guides/3.services.md) — Registering domain services
